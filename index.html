<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>虚拟手机</title>
    <script src="https://unpkg.com/dexie/dist/dexie.js"></script>
    <link rel="manifest" href="manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="虚拟手机">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180' viewBox='0 0 180 180'%3E%3Crect width='180' height='180' fill='%23667eea' rx='40'/%3E%3Ctext x='90' y='110' font-size='80' text-anchor='middle' fill='white'%3E📱%3C/text%3E%3C/svg%3E">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="mobile-container">
        <main id="home-screen" class="screen">
            <h1>主页</h1>
            <p>你好，我是 <span id="ai-name-display">...</span></p>
               <div class="app-grid">
                <div class="app-icon" id="open-chat-app"><div class="app-icon-bg">💬</div><span class="app-name">聊天</span></div>
                <div class="app-icon" id="open-wallet-app"><div class="app-icon-bg">💰</div><span class="app-name">钱包</span></div>
                <div class="app-icon" id="open-store-app"><div class="app-icon-bg">🛒</div><span class="app-name">商店</span></div>
                <div class="app-icon" id="open-backpack-app"><div class="app-icon-bg">🎒</div><span class="app-name">背包</span></div>
                <div class="app-icon" id="open-world-book-app"><div class="app-icon-bg">📖</div><span class="app-name">世界书</span></div>
                <div class="app-icon" id="open-settings-app"><div class="app-icon-bg">⚙️</div><span class="app-name">API设置</span></div>
                <div class="app-icon" id="open-general-settings-app"><div class="app-icon-bg">🔧</div><span class="app-name">通用设置</span></div>
            </div> <!-- app-grid 结束 -->

            <!-- 变量替换 Demo（只在首页显示） -->
            <details id="vars-demo" style="margin-top:14px;">
              <summary>变量调试面板</summary>
              <div style="padding:10px;border:1px dashed #bbb;border-radius:8px;font-size:14px;">
                <div><strong>模板（原文）</strong>：
                  现在是 {{time.hour}}:{{time.minute}}，{{ai.name}} 心情 {{ai.mood}}。
                  你有 {{player.inventory.length:0}} 件物品，聊天条数：{{chat.count}}，
                  离线收益/分：{{worldBook.rule001.value:1}}，随机数：{{random.10}}
                </div>
                <div style="margin-top:8px;"><strong>渲染结果</strong>：
                  <span id="vars-demo-result">（加载中…）</span>
                </div>
              </div>
            </details>
        </main>
        
        <section id="chat-screen" class="screen">
            <header class="chat-header"><button id="back-to-home-btn" class="back-btn">‹</button><h2 id="chat-header-title">与零的聊天</h2></header>
            <div id="message-container" class="message-container"></div>
            <form id="chat-input-form" class="chat-input-form">
                <button type="button" id="send-image-btn" class="chat-action-btn">📷</button>
                <input type="text" id="chat-input" placeholder="输入消息...">
                <button type="submit">发送</button>
            </form>
            <input type="file" id="image-input" accept="image/*" style="display: none;">
        </section>

        <section id="wallet-screen" class="screen">
            <header class="wallet-header">
                <button id="wallet-back-btn" class="back-btn">‹</button>
                <h2>我的钱包</h2>
                <button id="wallet-refresh-btn" title="刷新余额">↻</button>
            </header>
            <div class="wallet-content">
                <div class="balance-card">
                    <h3>你的余额</h3>
                    <p><span id="player-money-display">0</span> 金币</p>
                </div>
                <div class="balance-card">
                    <h3><span id="ai-name-wallet-display">AI</span>的余额</h3>
                    <p><span id="ai-money-display">0</span> 金币</p>
                </div>
            </div>
        </section>
        <section id="store-screen" class="screen"> <header class="store-header"><button id="store-back-btn" class="back-btn">‹</button><h2>商店</h2></header> <div class="store-content"><p>你的余额: <span id="store-player-money-display">0</span> 金币</p><div id="item-list" class="item-list"></div></div> </section>
        <section id="backpack-screen" class="screen"> <header class="backpack-header"><button id="backpack-back-btn" class="back-btn">‹</button><h2>我的背包</h2></header> <div id="inventory-list" class="inventory-list"></div> </section>
        
<section id="world-book-screen" class="screen">
    <header class="world-book-header">
        <button id="world-book-back-btn" class="back-btn">‹</button>
        <h2>世界书</h2>
    </header>
    
    <!-- 简约主界面 -->
    <div class="wb-container">
        <!-- 极简顶部栏 -->
        <div class="wb-minimal-top">
            <select id="wb-current-book" class="wb-select-minimal">
                <option value="">选择世界书...</option>
            </select>
            <div class="wb-top-actions">
                <button class="wb-mini-btn" onclick="WorldBookV2.createNewBook()" title="新建">➕</button>
                <button class="wb-mini-btn" onclick="WorldBookV2.editBookSettings()" title="设置">⚙️</button>
            </div>
        </div>
        
        <!-- 搜索栏 -->
        <div class="wb-search-bar">
            <input type="text" id="wb-search" class="wb-search-minimal" placeholder="搜索条目...">
            <button class="wb-add-btn" onclick="WorldBookV2.addEntry()">+ 新条目</button>
        </div>

        <!-- 批量操作栏（仅在有条目时显示） -->
        <div class="wb-batch-bar" id="wb-batch-bar" style="display:none;">
            <div class="wb-batch-info">
                <label class="wb-switch">
                    <input type="checkbox" id="wb-select-all" onchange="WorldBookV2.toggleSelectAll()">
                    <span>全选</span>
                </label>
                <span id="wb-selected-count" style="margin-left:10px;font-size:13px;color:#666;">已选: 0</span>
            </div>
            <div class="wb-batch-actions">
                <button class="wb-batch-btn" onclick="WorldBookV2.batchEnable(true)">启用</button>
                <button class="wb-batch-btn" onclick="WorldBookV2.batchEnable(false)">禁用</button>
                <button class="wb-batch-btn danger" onclick="WorldBookV2.batchDelete()">删除</button>
            </div>
        </div>

        <!-- 条目列表（极简卡片） -->
        <div class="wb-entries-list" id="wb-entries-list">
            <!-- 条目将在这里渲染 -->
        </div>
        
        <!-- 空状态 -->
        <div class="wb-empty" id="wb-empty-state" style="display:none;">
            <div class="wb-empty-icon">📖</div>
            <p>暂无条目</p>
            <button class="wb-empty-btn" onclick="WorldBookV2.addEntry()">创建第一个条目</button>
        </div>
    </div>
</section>

<!-- 条目编辑面板（重新设计） -->
<div id="wb-entry-panel" class="wb-panel">
    <div class="wb-panel-overlay" onclick="WorldBookV2.closePanel()"></div>
    <div class="wb-panel-content">
        <!-- 顶部标题栏 -->
        <div class="wb-panel-header">
            <input type="text" id="entry-name" class="wb-entry-title-input" placeholder="条目标题">
            <div class="wb-panel-buttons">
                <button class="wb-panel-btn" onclick="WorldBookV2.importEntry()" title="导入">📥</button>
                <button class="wb-panel-btn" onclick="WorldBookV2.exportEntry()" title="导出">📤</button>
                <button class="wb-panel-btn" onclick="WorldBookV2.deleteEntry()" title="删除">🗑️</button>
                <button class="wb-panel-btn" onclick="WorldBookV2.closePanel()" title="关闭">✖️</button>
            </div>
        </div>
        
        <!-- ID字段 -->
        <div class="wb-panel-field">
            <input type="text" id="entry-id" class="wb-input-minimal" placeholder="条目ID（唯一标识符）">
        </div>
        
        <div class="wb-panel-body">
            <!-- ①常驻和选择性触发 -->
            <div class="wb-switches">
                <label class="wb-switch">
                    <input type="checkbox" id="entry-constant">
                    <span>常驻</span>
                </label>
                <label class="wb-switch">
                    <input type="checkbox" id="entry-selective">
                    <span>选择性触发</span>
                </label>
            </div>
            
            <!-- ②触发关键词 -->
            <div class="wb-field">
                <label class="wb-label">触发关键词</label>
                <input type="text" id="entry-keys" class="wb-input" placeholder="关键词1, 关键词2, /正则/"> 
            </div>
            
            <!-- 可选关键词（可折叠） -->
            <details class="wb-collapsible">
                <summary>可选关键词</summary>
                
                <!-- ③触发条件 -->
                <div class="wb-field">
                    <label class="wb-label">触发条件（逻辑）</label>
                    <select id="entry-logic" class="wb-select">
                        <option value="AND_ANY">AND ANY（任一关键词）</option>
                        <option value="AND_ALL">AND ALL（所有关键词）</option>
                        <option value="NOT_ANY">NOT ANY（排除任一）</option>
                        <option value="NOT_ALL">NOT ALL（排除所有）</option>
                    </select>
                </div>
                
                <!-- ④辅助关键词 -->
                <div class="wb-field">
                    <label class="wb-label">辅助关键词</label>
                    <input type="text" id="entry-secondary-keys" class="wb-input" placeholder="额外的触发词">
                </div>
            </details>
            
            <!-- ⑤内容 -->
            <div class="wb-field">
                <label class="wb-label">
                    内容
                    <button class="wb-expand-btn" onclick="WorldBookV2.expandContent()" title="放大编辑">🔍</button>
                </label>
                <textarea id="entry-content" class="wb-textarea" rows="4" placeholder="当触发时注入的内容..."></textarea>
            </div>
            
            <!-- 高级设置（可折叠） -->
            <details class="wb-collapsible">
                <summary>高级设置</summary>
                
                <div class="wb-grid-2">
                    <!-- ⑥优先级 -->
                    <div class="wb-field">
                        <label class="wb-label">优先级</label>
                        <input type="number" id="entry-order" class="wb-input" value="100" min="0">
                    </div>
                    
                    <!-- ⑦位置 -->
                    <div class="wb-field">
                        <label class="wb-label">位置</label>
                        <select id="entry-position" class="wb-select">
                            <option value="before_char">角色定义前</option>
                            <option value="after_char">角色定义后</option>
                            <option value="before_example">示例消息前</option>
                            <option value="after_example">示例消息后</option>
                            <option value="before_an">作者注释前</option>
                            <option value="after_an">作者注释后</option>
                            <option value="depth_system">@Depth ⚙️系统</option>
                            <option value="depth_user">@Depth 👤用户</option>
                            <option value="depth_assistant">@Depth 🤖AI</option>
                        </select>
                    </div>
                    
                    <!-- ⑧深度 -->
                    <div class="wb-field">
                        <label class="wb-label">深度</label>
                        <input type="number" id="entry-depth" class="wb-input" value="4" min="0">
                    </div>
                    
                    <!-- ⑨概率 -->
                    <div class="wb-field">
                        <label class="wb-label">概率 <span id="prob-value">100%</span></label>
                        <input type="range" id="entry-probability" class="wb-range" min="0" max="100" value="100">
                    </div>
                </div>
                
                <!-- ⑩时序 -->
                <div class="wb-field">
                    <label class="wb-label">时序控制</label>
                    <div class="wb-grid-3">
                        <input type="number" id="entry-sticky" class="wb-input" placeholder="粘性" min="0">
                        <input type="number" id="entry-cooldown" class="wb-input" placeholder="冷却" min="0">
                        <input type="number" id="entry-delay" class="wb-input" placeholder="延迟" min="0">
                    </div>
                </div>
            </details>
            
            <!-- 递归扫描（可折叠） -->
            <details class="wb-collapsible">
                <summary>递归扫描</summary>
                
                <div class="wb-switches">
                    <label class="wb-switch">
                        <input type="checkbox" id="entry-disable-recursion">
                        <span>禁用递归</span>
                    </label>
                    <label class="wb-switch">
                        <input type="checkbox" id="entry-scan-depth">
                        <span>延伸扫描</span>
                    </label>
                </div>
                
                <div class="wb-field">
                    <label class="wb-label">递归深度</label>
                    <input type="number" id="entry-recursion-depth" class="wb-input" value="2" min="0" max="10">
                </div>
            </details>
            
            <!-- 其他（可折叠） -->
            <details class="wb-collapsible">
                <summary>其他</summary>
                
                <!-- 激活设置 -->
                <div class="wb-field">
                    <label class="wb-label">激活设置</label>
                    <div class="wb-grid-2">
                        <input type="number" id="entry-scan-depth-val" class="wb-input" placeholder="扫描深度" min="0">
                        <input type="number" id="entry-token-budget" class="wb-input" placeholder="Token预算" min="0">
                    </div>
                </div>
                
                <!-- 匹配规则 -->
                <div class="wb-switches">
                    <label class="wb-switch">
                        <input type="checkbox" id="entry-case-sensitive">
                        <span>区分大小写</span>
                    </label>
                    <label class="wb-switch">
                        <input type="checkbox" id="entry-whole-words">
                        <span>全词匹配</span>
                    </label>
                </div>
                
                <!-- 说话者限制（占位） -->
                <div class="wb-field">
                    <label class="wb-label">说话者限制（占位）</label>
                    <select id="entry-speaker" class="wb-select" disabled>
                        <option>任意</option>
                        <option>用户</option>
                        <option>AI</option>
                    </select>
                </div>
                
                <!-- 绑定设置 -->
                <div class="wb-field">
                    <label class="wb-label">条目绑定</label>
                    <div class="wb-switches">
                        <label class="wb-switch">
                            <input type="radio" name="entry-bind-type" id="entry-bind-global" value="global" checked onchange="WorldBookV2.toggleBindType()">
                            <span>🌍 全局</span>
                        </label>
                        <label class="wb-switch">
                            <input type="radio" name="entry-bind-type" id="entry-bind-character" value="character" onchange="WorldBookV2.toggleBindType()">
                            <span>👤 角色</span>
                        </label>
                    </div>
                    <select id="entry-character" class="wb-select" style="display:none;margin-top:8px;">
                        <option value="">选择角色...</option>
                        <option value="ai">零</option>
                        <option value="user">用户</option>
                    </select>
                </div>
            </details>
        </div>
        
        <!-- 底部按钮 -->
        <div class="wb-panel-footer">
            <button class="wb-btn-save" onclick="WorldBookV2.saveEntry()">保存条目</button>
            <button class="wb-btn-test" onclick="WorldBookV2.testEntry()">沙盒测试</button>
        </div>
    </div>
</div>

<!-- 内容编辑放大对话框 -->
<div id="wb-content-expand" class="wb-modal" style="display:none;">
    <div class="wb-modal-content">
        <div class="wb-modal-header">
            <h3>编辑内容</h3>
            <button class="wb-modal-close" onclick="WorldBookV2.closeExpandContent()">✖️</button>
        </div>
        <div class="wb-modal-body">
            <textarea id="expand-content" class="wb-expand-textarea" placeholder="在这里编辑内容..."></textarea>
        </div>
        <div class="wb-modal-footer">
            <button class="wb-btn-primary" onclick="WorldBookV2.saveExpandContent()">确定</button>
        </div>
    </div>
</div>

<!-- 世界书设置（简化版） -->
<div id="wb-book-settings" class="wb-modal" style="display:none;">
    <div class="wb-modal-content">
        <div class="wb-modal-header">
            <h3>世界书设置</h3>
            <button class="wb-modal-close" onclick="WorldBookV2.closeBookSettings()">✖️</button>
        </div>
        <div class="wb-modal-body">
            <div class="wb-field">
                <label>名称</label>
                <input type="text" id="book-name" class="wb-input" placeholder="世界书名称">
            </div>
            <div class="wb-field">
                <label>描述</label>
                <textarea id="book-description" class="wb-textarea" rows="2" placeholder="描述..."></textarea>
            </div>
            <div class="wb-field">
                <label>作用范围</label>
                <select id="book-scope" class="wb-select">
                    <option value="global">全局</option>
                    <option value="character">绑定角色</option>
                </select>
            </div>
            
            <!-- 全局激活设置（可折叠） -->
            <details class="wb-collapsible">
                <summary>🔧 全局激活设置</summary>
                
                <div class="wb-field">
                    <label class="wb-label">扫描深度 <span style="font-size:11px;color:#999">(回溯消息数)</span></label>
                    <input type="number" id="book-scan-depth" class="wb-input" value="2" min="0" max="100">
                </div>
                
                <div class="wb-field">
                    <label class="wb-label">Token预算 <span style="font-size:11px;color:#999">(上下文占用)</span></label>
                    <input type="number" id="book-token-budget" class="wb-input" value="2048" min="0">
                </div>
                
                <div class="wb-field">
                    <label class="wb-label">最小激活数 <span style="font-size:11px;color:#999">(至少触发条目数)</span></label>
                    <input type="number" id="book-min-activations" class="wb-input" value="0" min="0">
                </div>
                
                <div class="wb-field">
                    <label class="wb-label">最大递归层级</label>
                    <input type="number" id="book-max-recursion" class="wb-input" value="3" min="1" max="10">
                </div>
                
                <div class="wb-switches">
                    <label class="wb-switch">
                        <input type="checkbox" id="book-recursive" checked>
                        <span>启用递归扫描</span>
                    </label>
                    <label class="wb-switch">
                        <input type="checkbox" id="book-case-sensitive">
                        <span>区分大小写</span>
                    </label>
                </div>
                
                <div class="wb-switches">
                    <label class="wb-switch">
                        <input type="checkbox" id="book-match-whole-words" checked>
                        <span>全词匹配</span>
                    </label>
                    <label class="wb-switch">
                        <input type="checkbox" id="book-include-names" checked>
                        <span>包含说话者名</span>
                    </label>
                </div>
                
                <div class="wb-switches">
                    <label class="wb-switch">
                        <input type="checkbox" id="book-overflow-alert" checked>
                        <span>溢出警告</span>
                    </label>
                </div>
            </details>
        </div>
        <div class="wb-modal-footer">
            <button class="wb-btn-primary" onclick="WorldBookV2.saveBookSettings()">保存</button>
            <button class="wb-btn-secondary" onclick="WorldBookV2.exportBook()">导出</button>
            <button class="wb-btn-danger" onclick="WorldBookV2.deleteBook()">删除</button>
        </div>
    </div>
</div>

<!-- 测试沙盒 -->
<div id="wb-test-dialog" class="wb-modal" style="display:none;">
    <div class="wb-modal-content">
        <div class="wb-modal-header">
            <h3>沙盒测试</h3>
            <button class="wb-modal-close" onclick="WorldBookV2.closeTestDialog()">✖️</button>
        </div>
        <div class="wb-modal-body">
            <div class="wb-field">
                <label>测试文本</label>
                <textarea id="test-text" class="wb-textarea" rows="3" placeholder="输入测试文本..."></textarea>
            </div>
            <button class="wb-btn-primary" onclick="WorldBookV2.runTest()">运行测试</button>
            <div id="test-results" class="wb-test-results" style="display:none;">
                <h4>测试结果</h4>
                <div id="test-matches"></div>
            </div>
        </div>
    </div>
</div>
<section id="settings-screen" class="screen">
            <header class="settings-header">
                <button id="settings-back-btn" class="back-btn">‹</button>
                <h2>API 设置</h2>
            </header>
            <div class="settings-content">
                <div class="form-group preset-manager">
                    <label for="api-preset-select">API 预设</label>
                    <div class="preset-controls">
                        <select id="api-preset-select"></select>
                        <button id="new-preset-btn" class="preset-btn">+</button>
                        <button id="delete-preset-btn" class="preset-btn">-</button>
                    </div>
                </div>
                <hr class="separator">
                <div class="form-group">
                    <label for="preset-name-input">预设名称</label>
                    <input type="text" id="preset-name-input" placeholder="例如：我的Gemini">
                </div>
                <div class="form-group">
                    <label for="api-provider-select">API 服务商</label>
                    <select id="api-provider-select">
                        <option value="gemini">Google Gemini</option>
                        <option value="openai">OpenAI</option>
                        <option value="openai-compatible">OpenAI 兼容 (中转)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="api-endpoint-input">API 地址 / 中转站</label>
                    <input type="text" id="api-endpoint-input" placeholder="例如：https://api.openai.com/v1/chat/completions">
                </div>
                <div class="form-group">
                    <label for="api-key-input">API 密钥</label>
                    <input type="password" id="api-key-input" placeholder="在此输入你的密钥">
                </div>
                <div class="form-group">
                    <label for="api-model-input">模型名称</label>
                    <input list="api-models-list" id="api-model-input" name="model" placeholder="点击选择或手动输入...">
                    <datalist id="api-models-list"></datalist>
                    <button id="fetch-models-btn" class="form-button-secondary" style="margin-top: 10px;">拉取可用模型</button>
                </div>
                <div class="api-test-container">
                    <button id="test-api-btn" class="form-button-secondary">测试连接</button>
                    <span id="api-status-indicator"></span>
                </div>
                <button id="save-settings-btn" class="form-button">保存当前预设</button>
                <hr class="separator">
                <div class="form-group">
                    <label>数据备份与恢复</label>
                    <button id="export-data-btn" class="form-button-secondary">导出备份文件</button>
                    <button id="import-data-btn" class="form-button-secondary" style="margin-top: 10px;">导入备份文件</button>
                    <input type="file" id="import-file-input" accept=".json" style="display: none;">
                </div>
            </div>
        </section>

        <section id="general-settings-screen" class="screen">
            <header class="settings-header">
                <button id="general-settings-back-btn" class="back-btn">‹</button>
                <h2>通用设置</h2>
            </header>
            <div class="settings-content">
                <div class="form-group">
                    <label for="ai-persona-textarea">AI 核心性格 (AI Persona)</label>
                    <textarea id="ai-persona-textarea" rows="4" placeholder="定义AI的性格、背景故事、说话风格..."></textarea>
                </div>
                <div class="form-group">
                    <label for="my-persona-textarea">我的虚拟形象 (My Persona)</label>
                    <textarea id="my-persona-textarea" rows="3" placeholder="告诉AI，你希望它如何看待你..."></textarea>
                </div>
                <hr class="separator">
                <div class="form-group">
                    <label>关联世界书 (为当前聊天)</label>
                    <div id="world-book-linking-container" style="padding: 10px; background: #f0f0f0; border-radius: 6px; min-height: 50px;">
                    </div>
                </div>
                 <hr class="separator">
                <div class="form-group" style="display: flex; justify-content: space-between; align-items: center;">
                    <label for="chain-of-thought-switch" style="margin-bottom: 0;">启用思维链（让AI后台思考）</label>
                    <input type="checkbox" id="chain-of-thought-switch" style="width: auto; height: 20px;">
                </div>
                <div class="form-group" style="display: flex; justify-content: space-between; align-items: center; margin-top: -10px; padding-left: 20px;">
                    <label for="show-thought-alert-switch" style="margin-bottom: 0; font-size: 13px; color: #666;">显示思维过程（弹窗+对话框）</label>
                    <input type="checkbox" id="show-thought-alert-switch" style="width: auto; height: 18px;">
                </div>
                  <button id="save-general-settings-btn" class="form-button">保存通用设置</button>
                  <button id="debug-settings-btn" class="form-button-secondary" style="margin-top: 10px;">调试设置状态</button>
                  <button id="fix-data-btn" class="form-button-secondary" style="margin-top: 10px;">修复数据兼容性</button>
                  <button id="clean-thought-btn" class="form-button-secondary" style="margin-top: 10px;">清理思维链显示问题</button>
              </div>
          </section>
                <section id="lock-screen" class="screen">
            <div class="time-display">10:24</div>
            <div class="unlock-prompt">点击屏幕以解锁</div>
        </section>
    </div>

   <!-- 模块化的脚本引入 -->
    <!-- 核心模块 -->
    <script src="js/config.js"></script>
    <script src="js/state.js"></script>
    <script src="js/database.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/ai.js"></script>
    
    <!-- 界面模块 -->
    <script src="js/screens/chat.js"></script>
    <script src="js/screens/wallet.js"></script>
    <script src="js/screens/store.js"></script>
    <script src="js/screens/backpack.js"></script>
    <script src="js/screens/worldbook.js"></script>
    <script src="js/screens/settings.js"></script>
    <script src="js/screens/general-settings.js"></script>

    <!-- 主入口（必须最后加载） -->
    <script src="js/main.js"></script>
    <script>
    // 注册Service Worker
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js').then(reg => {
            console.log('Service Worker registered');
        });
    }
    </script>
</body>
</html>
